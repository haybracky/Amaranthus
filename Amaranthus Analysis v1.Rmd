---
title: "Amaranthus Analysis v1"
author: "Hayley Brackenridge"
date: '2019-01-24'
output: html_document
---

# Preamble

This markdown contains preliminary analysis of *Amaranthus palmeri* data from 2018-2019 greenhouse project. 

```{r load data}
palmer<- read.csv("Amaranthus Male and Female Harvest Combined Data v4.csv")
str(palmer)
palmer$Inflo.length.19<- as.numeric(palmer$Inflo.length.19)
palmer$Inflo.length.59<- as.numeric(palmer$Inflo.length.63)
palmer$Inflo.length.63<- as.numeric(palmer$Inflo.length.63)
palmer$Inflo.length.265<- as.numeric(palmer$Inflo.length.265)
palmer$Inflo.length.278<- as.numeric(palmer$Inflo.length.278)

library(ggplot2)
library(lattice)
library(dplyr)
library(knitr)
library(IDPmisc)

palmer<- select(palmer, -Notes)
names(palmer)
```

# Branches

## Sum stats

Summary statistics of branch length and number

```{r branch sum stats}
# make branch means col
palmer$branch.means<- rowMeans(palmer[,11:39], na.rm=TRUE) # note: remember to change this if dataset changes
print(palmer$branch.means)

# make branch mins col
palmer$branch.mins<- apply(palmer[,11:39], 1, FUN=min, na.rm=TRUE)
print(palmer$branch.mins)

# make branch maxs col
palmer$branch.maxs<- apply(palmer[,11:39], 1, FUN=max, na.rm=TRUE)
print(palmer$branch.maxs)

# make branch num col


# make branch sum col
palmer$branch.sum<- apply(palmer[,11:39], 1, FUN=sum, na.rm=TRUE)
print(palmer$branch.sum)

# make object storing branch summary stats grouped by population
BranchSum<- palmer %>%
  group_by(Population) %>%
  summarize(AvMin=mean(NaRV.omit(branch.mins)),
            MinSD=sd(NaRV.omit(branch.mins)),
            AvMax=mean(NaRV.omit(branch.maxs)),
            MaxSD=sd(NaRV.omit(branch.maxs)),
            Mean=mean(branch.means, na.rm=TRUE), 
            MeanSD=sd(branch.means, na.rm=TRUE),
            AvSum=mean(branch.sum, na.rm=TRUE), 
            SumSD=sd(branch.sum, na.rm=TRUE)) %>%
  arrange(desc(Mean))

# make table of branch summary stats
BranchSumTable<- kable(BranchSum)
print(BranchSumTable)

# summary stats grouping by sex
BranchbySexSum<- palmer %>%
  group_by(Population, Sex) %>%
  summarize(AvMin=mean(NaRV.omit(branch.mins)),
            MinSD=sd(NaRV.omit(branch.mins)),
            AvMax=mean(NaRV.omit(branch.maxs)),
            MaxSD=sd(NaRV.omit(branch.maxs)),
            Mean=mean(branch.means, na.rm=TRUE), 
            MeanSD=sd(branch.means, na.rm=TRUE),
            AvSum=mean(branch.sum, na.rm=TRUE), 
            SumSD=sd(branch.sum, na.rm=TRUE)) %>%
  arrange(Population)

BranchbySexSumTable<-kable(BranchbySexSum)
print(BranchbySexSumTable)
```
**Note:** could not figure out how to find branch count

## models

modelling branch measurements against other variables

```{r branch mod}
branchmod1<- lm(branch.means~Population, data=palmer)
summary(branchmod1)

branchmod2<- lm(branch.means~Sex, data=palmer)
summary(branchmod2)

branchmod3<- lm(branch.means~Population+Sex, data=palmer)
summary(branchmod3)
```


## qplots

qplots comparing branches

```{r branch plots}

```

# Inflos

## Sum stats 

Summary statistics of branch length and number

```{r inflo sum stats}
# make inflo means col
palmer$inflo.means<- rowMeans(palmer[,41:591], na.rm=TRUE) # note: remember to change this if dataset changes
print(palmer$branch.means)

# make inflo mins col
palmer$inflo.mins<- apply(palmer[,41:591], 1, FUN=min, na.rm=TRUE)
print(palmer$inflo.mins)

# make inflo maxs col
palmer$inflo.maxs<- apply(palmer[,41:591], 1, FUN=max, na.rm=TRUE)
print(palmer$inflo.maxs)

# make inflo num col


# make inflo sum col
palmer$inflo.sum<- apply(palmer[,41:591], 1, FUN=sum, na.rm=TRUE)
print(palmer$inflo.sum)

# make object storing inflo summary stats grouped by population
InfloSum<- palmer %>%
  group_by(Population) %>%
  summarize(AvMin=mean(NaRV.omit(inflo.mins)),
            MinSD=sd(NaRV.omit(inflo.mins)),
            AvMax=mean(NaRV.omit(inflo.maxs)),
            MaxSD=sd(NaRV.omit(inflo.maxs)),
            Mean=mean(inflo.means, na.rm=TRUE), 
            MeanSD=sd(inflo.means, na.rm=TRUE),
            AvSum=mean(inflo.sum, na.rm=TRUE), 
            SumSD=sd(inflo.sum, na.rm=TRUE)) %>%
  arrange(desc(Mean))

# make table of inflo summary stats
InfloSumTable<- kable(InfloSum)
print(InfloSumTable)

# summary stats grouping by sex
InflobySexSum<- palmer %>%
  group_by(Population, Sex) %>%
   summarize(AvMin=mean(NaRV.omit(inflo.mins)),
            MinSD=sd(NaRV.omit(inflo.mins)),
            AvMax=mean(NaRV.omit(inflo.maxs)),
            MaxSD=sd(NaRV.omit(inflo.maxs)),
            Mean=mean(inflo.means, na.rm=TRUE), 
            MeanSD=sd(inflo.means, na.rm=TRUE),
            AvSum=mean(inflo.sum, na.rm=TRUE), 
            SumSD=sd(inflo.sum, na.rm=TRUE)) %>%
  arrange(Population)

InflobySexSumTable<-kable(InflobySexSum)
print(InflobySexSumTable)
```

## models

modelling inflo measurements against other variables 

```{r inflo mod}
inflomod1<- lm(inflo.means~Population, data=palmer)
summary(inflomod1)

inflomod2<- lm(inflo.means~Sex, data=palmer)
summary(inflomod2)

inflomod3<- lm(inflo.means~Population+Sex, data=palmer)
summary(inflomod3)
```


## qplots
